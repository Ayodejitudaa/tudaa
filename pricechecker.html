<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <title>Official Homepage For TUDAA</title>
</head>
<body>
  <table width="800" cellpadding="0" border="1" align="center">
    <tbody>
      <tr>
        <td bgcolor="#ffffff" colspan="2">
          <p class="run">
  
            <p style="text-align: center;"><strong>TUDAA</strong> is a software development firm.</p>
            <p style="text-align: center;"><strong>Running locally on new branch</strong></p>
  
            <p>Real-Time Prices</p>
  
            <!-- Add buttons to initiate auth sequence and sign out -->
            <button id="authorize_button" onclick="handleAuthClick()">Authorize</button>
            <button id="signout_button" onclick="handleSignoutClick()">Sign Out</button>
  
            <pre id="content" style="white-space: pre-wrap;"></pre>
  
            <script type="text/javascript">
              /* exported gapiLoaded */
              /* exported gisLoaded */
              /* exported handleAuthClick */
              /* exported handleSignoutClick */
            
              // TODO(developer): Set to client ID and API key from the Developer Console
              const CLIENT_ID = '434024385083-ns8a6h405ts25aahi7gq8sq6r10fedja.apps.googleusercontent.com';
              const API_KEY = 'AIzaSyDpLFAuRI-vItdSrIaCPpc4OX_PzgLs9Z0';
            
              // Discovery doc URL for APIs used by the quickstart
              const DISCOVERY_DOC = 'https://sheets.googleapis.com/$discovery/rest?version=v4';
            
              // Authorization scopes required by the API; multiple scopes can be
              // included, separated by spaces.
              const SCOPES = 'https://www.googleapis.com/auth/spreadsheets.readonly';
            
              let tokenClient;
              let gapiInited = false;
              let gisInited = false;
            
              document.getElementById('authorize_button').style.visibility = 'hidden';
              document.getElementById('signout_button').style.visibility = 'hidden';
            
              /**
               * Callback after api.js is loaded.
               */
              function gapiLoaded() {
                gapi.load('client', initializeGapiClient);
              }
            
              /**
               * Callback after the API client is loaded. Loads the
               * discovery doc to initialize the API.
               */
              async function initializeGapiClient() {
                await gapi.client.init({
                  apiKey: API_KEY,
                  discoveryDocs: [DISCOVERY_DOC],
                });
                gapiInited = true;
                maybeEnableButtons();
              }
            
              /**
               * Callback after Google Identity Services are loaded.
               */
              function gisLoaded() {
                tokenClient = google.accounts.oauth2.initTokenClient({
                  client_id: CLIENT_ID,
                  scope: SCOPES,
                  callback: '', // defined later
                });
                gisInited = true;
                maybeEnableButtons();
              }
            
              /**
               * Enables user interaction after all libraries are loaded.
               */
              function maybeEnableButtons() {
                if (gapiInited && gisInited) {
                  document.getElementById('authorize_button').style.visibility = 'visible';
                }
              }
            
              /**
               *  Sign in the user upon button click.
               */
              function handleAuthClick() {
                tokenClient.callback = async (resp) => {
                  if (resp.error !== undefined) {
                    throw (resp);
                  }
                  document.getElementById('signout_button').style.visibility = 'visible';
                  document.getElementById('authorize_button').innerText = 'Refresh';
                  await displayBTCPrice();
                };
            
                if (gapi.client.getToken() === null) {
                  // Prompt the user to select a Google Account and ask for consent to share their data
                  // when establishing a new session.
                  tokenClient.requestAccessToken({prompt: 'consent'});
                } else {
                  // Skip display of account chooser and consent dialog for an existing session.
                  tokenClient.requestAccessToken({prompt: ''});
                }
              }
            
              /**
               *  Sign out the user upon button click.
               */
              function handleSignoutClick() {
                const token = gapi.client.getToken();
                if (token !== null) {
                  google.accounts.oauth2.revoke(token.access_token);
                  gapi.client.setToken('');
                  document.getElementById('content').innerText = '';
                  document.getElementById('authorize_button').innerText = 'Authorize';
                  document.getElementById('signout_button').style.visibility = 'hidden';
                }
              }
            
              /**
               * Print BTC price in the spreadsheet below:
               * https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit
               */
              async function displayBTCPrice() {
                  try {
                      const response = await gapi.client.sheets.spreadsheets.values.batchGet({
                          spreadsheetId: "1dEPIHor0N03uh1VAm3SSWbzvx-tt7kJBakWhS3JijMQ",
                          ranges: ["tudaa!A2:E34", "tudaa!A37:B40"],
                      });

                      const valueRanges = response.result.valueRanges;

                      if (valueRanges.some(range => !range || !range.values || range.values.length === 0)) {
                          document.getElementById("content").innerText = "No values found.";
                          return;
                      }

                      const tableHTML = valueRanges.map(range => {
                          return `<table border='1|1'>${range.values
                              .map(row => `<tr>${row.map(cell => `<td>${cell}</td>`).join("")}</tr>`)
                              .join("")}</table>`;
                      }).join("");

                      const contentElement = document.getElementById("content");
                      contentElement.innerHTML = tableHTML;

                      const blockchainData = valueRanges[1].values.reduce((str, row) => `${str}${row[0]} ${row[1]}\n`, "");
                      contentElement.insertAdjacentHTML("beforeend", "\n<b>Blockchain Data (Last Block)</b>\n");
                      contentElement.insertAdjacentText("beforeend", blockchainData);
                  } catch (err) {
                      console.error("Error fetching data:", err);
                      document.getElementById("content").innerText = "Error fetching data.";
                  }
              }

            </script>
  
            <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
            <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
  
            <p></p>
          </p>
        </td>
      </tr>
    </tbody>
  </table><br />
  
</body>
</html>